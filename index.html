<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OKR - Dashboard</title>
    <link rel="icon" href="css/favicon.png" type="image/x-icon">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/shepherd.js@10.0.1/dist/css/shepherd.css"/>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://unpkg.com/pizzip@3.1.1/dist/pizzip.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docxtemplater/3.57.3/docxtemplater.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    
    <style>
        /* Štýly pre .main-view boli presunuté do _layout.css pre plynulejší prechod */
    </style>
    </head>
<body>
    <div class="dashboard-container">
        <aside class="dashboard-sidebar">
            <div class="sidebar-header">
                <img src="css/logo.png" alt="Logo OKR" class="sidebar-logo">
                <h3>OKR</h3>
            </div>
            
            <div class="sidebar-context">
                <label for="okresny-urad" class="context-label">Pracovisko</label>
                <div id="ou-select-wrapper" class="select-item">
                    <i class="fas fa-building"></i>
                    <select name="okresny-urad" id="okresny-urad">
                        <option value="">--- Prosím, vyberte OÚ ---</option>
                    </select>
                </div>
            </div>

            <nav class="sidebar-nav">
                <label class="context-label">Agendy</label>
                <ul class="nav-list" id="agenda-navigation">
                    <li><a href="#" class="nav-link" data-agenda="vp"><i class="fas fa-truck"></i><span>Vecné prostriedky</span></a></li>
                    <li><a href="#" class="nav-link" data-agenda="pp"><i class="fas fa-briefcase"></i><span>Pracovná povinnosť</span></a></li>
                    <li><a href="#" class="nav-link" data-agenda="ub"><i class="fas fa-bed"></i><span>Ubytovanie</span></a></li>
                    <li><a href="#" class="nav-link" data-agenda="dr"><i class="fas fa-envelopes-bulk"></i><span>Doručovatelia</span></a></li>
                </ul>
            </nav>
            
            <div class="sidebar-footer">
                <div class="notification-bell-wrapper" data-tooltip="Notifikácie">
                    <button id="notification-bell-btn" class="btn btn--secondary">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge" style="display: none;">0</span>
                    </button>
                    <div id="notification-center-panel" class="notification-center-panel">
                        <div class="notification-panel-header">
                            <h4>Notifikácie</h4>
                            <button id="clear-notifications-btn">Vymazať všetky</button>
                        </div>
                        <ul id="notification-list" class="notification-list">
                            <li class="empty-state">Zatiaľ žiadne nové notifikácie.</li>
                        </ul>
                    </div>
                </div>
                
                <button id="show-help-center" class="btn btn--secondary" data-tooltip="Centrum nápovedy"><i class="fas fa-life-ring"></i></button>
                <button id="reset-tour-btn" class="btn btn--secondary" data-tooltip="Zobraziť sprievodcu"><i class="fas fa-route"></i></button>
                <button id="reset-app-btn" class="btn btn--secondary" data-tooltip="Resetovať aplikáciu"><i class="fas fa-sync-alt"></i></button>
            </div>
        </aside>

        <main id="dashboard-content" class="dashboard-content">
            
            <div id="welcome-view" class="main-view active">
                <div class="welcome-message" style="height: calc(100vh - 4rem);">
                    <i class="fas fa-hand-pointer"></i>
                    <h2>Vitajte v aplikácii</h2>
                    <p>Prosím, začnite výberom okresného úradu v paneli vľavo.</p>
                </div>
            </div>

            <div id="agenda-view" class="main-view">
                <div class="content-header">
                    <h2></h2>
                    <div class="header-meta">
                        <div class="selection-summary">
                            <strong>Okresný úrad:</strong> <span></span>
                        </div>
                        <div class="spis-display spis-display--editable" data-tooltip="Kliknutím zmeníte číslo spisu">
                            <i class="fas fa-folder"></i>
                            <span></span>
                        </div>
                    </div>
                </div>

                <div class="agenda-tabs-container">
                    <button class="agenda-tab active" data-tab="spracovanie">
                        <i class="fas fa-sign-in-alt"></i> 1. Spracovanie dát
                    </button>
                    <button class="agenda-tab is-disabled" data-tab="generovanie">
                        <i class="fas fa-file-export"></i> 2. Generovanie
                    </button>
                </div>

                <div class="agenda-tab-content-wrapper">
                    <div id="tab-spracovanie" class="agenda-tab-content active">
                        <div class="workflow-step" style="padding: 1.5rem 2rem;">
                            <h3>Vstupné súbory</h3>
                            <div id="file-inputs-container" style="display: flex; flex-direction: column; gap: 1rem;"></div>
                        </div>
                        <div class="workflow-step" style="margin-top: 2rem; padding: 1.5rem 2rem;">
                            <h3>Náhľad a kontrola dát</h3>
                            <div id="preview-container" class="data-preview">
                                <div class="empty-state-placeholder">
                                    <i class="fas fa-file-import"></i>
                                    <h4>Náhľad sa zobrazí po nahratí súborov</h4>
                                    <p>Začnite nahratím vstupných súborov.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="tab-generovanie" class="agenda-tab-content">
                        <div class="workflow-step" style="padding: 1.5rem 2rem;">
                            <h3>Generovanie dokumentov</h3>
                            <div id="generators-container" class="generators-grid"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="help-view" class="main-view">
                </div>

        </main>
        </div>
    
    <div id="spinner-overlay" class="spinner-overlay" style="display: flex;"><div class="spinner"></div></div>
    <div id="modal-container"></div>
    
    <script src="js/config.js" type="module"></script>
    <script src="js/ui.js" type="module"></script>
    <script src="js/DocumentProcessor.js" type="module"></script>
    <script src="js/agendaConfigFactory.js" type="module"></script>
    <script src="https://cdn.jsdelivr.net/npm/shepherd.js@10.0.1/dist/js/shepherd.min.js"></script>
    <script src="js/tour.js" type="module"></script>
    <script src="js/main-wizard.js" type="module"></script>

    <div id="spinner-overlay" class="spinner-overlay" style="display: flex;"><div class="spinner"></div></div>
    <div id="modal-container"></div>
    
    <div id="notification-toast-container"></div> 
    
    <script src="js/config.js" type="module"></script>
</body>
</html>